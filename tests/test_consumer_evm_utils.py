import pytest

from vrf_worker.consumer.evm.utils import _recover_address, trim_proof


@pytest.fixture
def mock_evm_proof() -> bytes:
    return bytes.fromhex(
        "0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000212000000000000000000000000000000000000000000000000000000000000020c01d7e4b8fdb91d3c62f03fde7a502ef1f6e517b6455f91a1459c170734d56e83c6138eca2f2e6c71958539e1a5d346f8846226c92636dbfe82db2329857b613b81bbbdcdd9446268317903d992af3ffbbbd62ae3f87c0ad69c5e5fe503224bb1289e6175a7b2650180d387c403ae10475b70d77113fdbeea62dd0061d900093002879e29fbc1689ec000bd1489fe14974fe39a92233c6c423e0c7e85eaa5c9dea31d1ea84ba954cbbf975e2762f8b19c7da07d4add5b9414250c91de04dd11a81947000cd8780693dc08cb0a86f9f3db35d28ad2a7055de72095404edec76115000000000000000000000000000000000000000000000000000000000004b6bd60000000000000000000000000000000000000000000000000000000067e4f24e0000000000000000000000000000000000000000000000000000000036ea23553fb895ba5763257c803061586fd1f9f31d534dec9d91d6d571de6c58b24ca74c1619d4aa71f4a12f37645a141d8ffafe0ecd6ba98f7270926beab7a7178497cfdbd0de414957ecbf9eb0a6203d5e4de5ab1aed6bf680fcec58d8f139d2aa45c4c1b6c9892812d91aca9425a3440a75c54c0df7ee1508ea415046b09b2d19f1db000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000f080211d66b4b000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026122408011220ead12b282c85aefb0d415df82c564287f3a6bbac44749470aeca8c88a191a806000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000440000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000005c000000000000000000000000000000000000000000000000000000000000006800000000000000000000000000000000000000000000000000000000000000740000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000008c000000000000000000000000000000000000000000000000000000000000009800000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000000bc00000000000000000000000000000000000000000000000000000000000000c800000000000000000000000000000000000000000000000000000000000000d400000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000ec00000000000000000000000000000000000000000000000000000000000000f800000000000000000000000000000000000000000000000000000000000001040000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000011c000000000000000000000000000000000000000000000000000000000000012800000000000000000000000000000000000000000000000000000000000001340000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000014c000000000000000000000000000000000000000000000000000000000000015800000000000000000000000000000000000000000000000000000000000001640000000000000000000000000000000000000000000000000000000000000170000000000000000000000000000000000000000000000000000000000000017c0000000000000000000000000000000000000000000000000000000000000188000000000000000000000000000000000000000000000000000000000000019400000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001ac00000000000000000000000000000000000000000000000000000000000001b800000000000000000000000000000000000000000000000000000000000001c400000000000000000000000000000000000000000000000000000000000001d0012055e45d3a2e6297f9309f08d920d8540b5742804d8627c38343a14a17589024c14cd6c9e1eef6d11e5851ae4a74155b92b3bdb1c3092a1db4f5de03ee0e2bf000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06108592f1d002000000000000000000000000000000000000000013bae22dc91385ea433004d784af443765eecb849892fca33dc842ac9a5613657b14eec7baa7fede0309d40b7c28ef99444e5460299f2b93ed1b936b67573a97000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f494ede60200000000000000000000000000000000000000004e3184dc913990b0209c4327408bbe9c5eba87afce293c6140ecb635c72bad673ef779dde0391a3172024daa4f4a1b5764a41e6409a38c35633652a31fff75e0000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ddbceede020000000000000000000000000000000000000000428044f0f4fdc61bc660063aac3b81b4d2661f792dd4f38fd814f36f4c19c6622a4452eb9a24eadebb648113b50f927b350a479565b25b1a76fa708260030d12000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610dd88c6d80200000000000000000000000000000000000000004375d7e130aa5138443ff45174d298058fdd4baff5c2ded7689b7a851b9e737732dce70a806dd5ec49aab4b1f27f7be990197bf685d4b2416e640c591687a745000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b181d4da02000000000000000000000000000000000000000028c350213268af29f25dcdbefe244a05d48abd3b25ef5b6d0e370aa8039798933d9d5eb8cb8708e81c7d489528c44fd56c2f8af709b04948fdbe09d130e20816000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ce94fde0020000000000000000000000000000000000000000938ee978a988320d1d8fc792c234745b87a0bfdd745b9724fd0cb702e89f60680555eea11c88af6a34d6e3e97ba86f826a8fc3a9cdd4e9bc903cc4be59bec455000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bd81a2d00200000000000000000000000000000000000000005f5febe1f0267df6445c550495c00faa9705c18a63e287caf8bbfe53a35b21d60f13aed64328252cbbf9c1ff0a3ec1bf1a8b59ae9c274ba4b62c1bc300c5bccb000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610e5beb9cd0200000000000000000000000000000000000000002e0729a1396b707d750ab066bb310ae3d6829e7c1aa2d100b25c011ae5ca54b74997de810963a7d0b14d507acc9605bac5726f8b95dc6954869b9d9abf3e495f000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b7bfc8ea020000000000000000000000000000000000000000d011d9c94344a1586e02349846513aea3927874c5f6249c2638a32c849effe247f37b96bf42034366c465afea6cf13f82c3e4852618496e947f52faf81f9cdf1000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610c5b4c7fe02000000000000000000000000000000000000000097d8951e55ccdcf1db77b7cfb1f059c2806e17ab4eacc510e49a8377d351ab3c0123099b90d8266bb2182eab09fdd173ed4fdf99dc93b5ad729c6424254474a6000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06109f9ce6d00200000000000000000000000000000000000000006225b22f628e11b20bd39c11713db88521d1aa5f07ef4605fb58bc96f0104e721cff01825a49df117c14dd3951dc5ba7ab96bce00813205c13e0578f7548d48b000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000b08d0e493bf0610d9bbdd5b000000000000000000000000000000000000000000eef9b3aa497cc56c08d96448ace0ac05108a7b83bfa9ed604d47648ae52987c23d9173f1bd2491ca990dd5584d78b810f014911e53cfe889df07ecbab1a04183000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f2a1edcc0200000000000000000000000000000000000000007cf8579d04f90e415af60560a881e471da24aa8af83ce4d02c65c3a93e4ebd135b2b693fb29d3622006db29f75e92460edfad12f4248824cccd4808764da08b8000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f4fc90d30200000000000000000000000000000000000000005aeed6f353bce82c13463ec2863131b0c5409cee51657258bd9da63807cc5de73104f58ccd8654db72cff3f7a68e3ece9a5087c2f026c40fc9a83a42a2b24b90000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000b08d0e493bf06109cc59310000000000000000000000000000000000000000000ddc2479c71f7160394b714216f8d6d550d88dd2e1a9dbbb07c8dffdafbcbb9c0138582b2cd7ffba139f4fe765f58bc093d2cf3f67fd46afd4a2ab8654f912630000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ddcc95cf020000000000000000000000000000000000000000f30c639044188427b5eaecc532645024a7bc0d8c8d591cea9b5bd3b09448645c5b5727b2fe804495325d06a4d4f99137d00823ac0804867901870a9899b8ea41000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf061086c4e3f702000000000000000000000000000000000000000044ac7e69a1b7291d0bff41e411b451ba6fba9f1c1af3a7a93525e7462c3a6361414986a53f020de4d3044d5f158a2c2d702e95b7f6b1b2764edf400e4e814701000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bf9987d30200000000000000000000000000000000000000008ee5e304e4432fc93b1357b22d42c3dd0237057cb49f37d51973454fe52a008f1439e5961e6bd12add46d0691dc42600411e3851522b00771fa25684af4551a8000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ee9186d50200000000000000000000000000000000000000004c4456aded10eb474325de34c21750ce50128f615522b13f2f77288b8219c09513a82c3a7e44581a031a62e57a7abef4ea38a894577749b6dbaa51e104f62379000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06109291a7d502000000000000000000000000000000000000000067cd71cadd788be05b0c2befc771360d854627ad779b6e13d2960f12244a96bf61762b96220fac84ac59c57039d2830d36888326d5ca8bf2f36433d87b2ea46a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06108cd4b9e1020000000000000000000000000000000000000000b8461c2c37de3f0169dc1ea274ee10d782d9bcfefa57147754172bb349f12d68444fb66d04717d4b95e96a9abd8d06ebeaab69d5fd45d4dc7fde2cde794082dc000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b49c85d2020000000000000000000000000000000000000000c153f4727e919f43b03eda327d3341266b74dc01cf0246bb3dc928735f6c8bf528251e09fc6151a37f19d0f6673183a764612784039d46e5c35ca07067fe497d000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bef193d702000000000000000000000000000000000000000054b732ae6fbdf6eac87eee414389fd6b7df651bc8f7c5d9f0619c30f1c9182982a51247b9d43c50b8e516a406c2df20cad213246c0cc9936c35ca712e1fc2be6000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b4d9dad3020000000000000000000000000000000000000000024609f514120df47a9c31093a52b176c5f8b28df0ca02cf270e01c14447f284455958343d12d6b341ae3b23d8307bc6517f723ef2a607a2aa980f6b9e446aed000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f1dba4ce020000000000000000000000000000000000000000b932cc856781506424a9c52281b2ff5d4a793f506c0c3c6bfef0c554b5d704ea034f8932641bf858e0cbec9546ababc92e18ecdf4cc03ad18ab1f28cb186c6c6000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610dcf395cf020000000000000000000000000000000000000000c1360c3ce8352da83bf2982d85d898af6168f5ff993a5b8c5d897c8fcfd44c5200d65dd83a46a046bd5b900ab75aace23eeafae339119ac31477ebdf51632979000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b4a7a0d60200000000000000000000000000000000000000006f78bc36c0ef172abfb488bfa38bac26dafdb97e4875e2b1f42f2511add2433f005976eaea645423246b73e3e37abff0d1a0343b823601cbe2a84772b3836c8d000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bfe48794030000000000000000000000000000000000000000d58ef62a35f9d93c4cb5036135d188b89078a965c5375e3e29963b98a8cae5d1242ed3908f99bbe00665c613b0ca4be7c12d4a399674ccc6addaebd24c7ca013000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610c2f3d0f402000000000000000000000000000000000000000090cf0cfb782a99456da547470b19f65c2d6f899e0c7b76d279d244b5169a1cc902001f70a313b836f61ee6e3e3b7cb3d47a4c83eb2c976c7171ead9086072c80000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610cb9bbbd50200000000000000000000000000000000000000008f7a515cdb534f0532a0ac17bebab4bdefe456683a4fccdc35249ff74b1a840d565d962cc0cfd02d791a194c1ba6eb52ce148b15b884ade0e2f2c3d4252f080f000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b8df8cdd020000000000000000000000000000000000000000308c44836126967ac264dc12ad92da8818f8b2598fb37b44939b5c8cbc4a2d6e7e2dc5e8d60966e29052d6ec5836c63c15b46d44a1554881646b53069f2abcd4000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ec9aa3cc020000000000000000000000000000000000000000529a4eb95ba3a5d0fa0587395deba5dcf3f19242bf04691d7a892678c710f3a15456ff481b81c8d02a457701cfa4ebd63434b0d7d5c2236cda6d2bc0fe0b797d000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610d2b98edc020000000000000000000000000000000000000000018b922fa8b7cbe517e7e5fb57e0de75b559011e76f253d9a3ca74f7bcccccf668a304fe7ddf1d56ebcb7c18249bd3bc2e0c65c22c3257b6423574ba07ceb0bf000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ea95a1dc0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dc000000000000000000000000000000000000000000000000000000000004b6bd6000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000004b6bcf00000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000016ba800000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000067e4f2440000000000000000000000000000000000000000000000000000000067e4f24600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000000a7672665f776f726b6572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044000000205c8ae7cfab9f5b0e1be04a5cc6b00f51844d92cac71322190e030fdc82a5e5a90000000067e3670800000014b5a4643d61f2bc214d453b501c2d06089e6880d3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000203a0ae8974c402d8286e4b71dceb368a96cbf80aaecb2ef99b7dd983b06267ea700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000004b6bcf8ecb7eca2dff1794f1b0cf4ee02d7ccdc3b68f20bda482bec659059fcf93ff8a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000004b6bcfe4f1f38396518d67512a53fab3b46aac97bd15e9142bcfb218a290712c4dc7f600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000004b6bcf0231216a07400fab9e45d493fbb411834622c7f3ace58197f4ed746abdb9e10600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000000000000004b6bcf090bb53ef4d133b4be4a0611ee9b513731188dbdf7ea4958ef4895d5dfea8a8100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001f00000000000000000000000000000000000000000000000000000000004b6bcf925a8a7af4548e8f10ad98439bd20c11172d31ba479662d9e1b8998f778ccdac00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002f00000000000000000000000000000000000000000000000000000000004b6bcfa69a5ba6060b08a51e2ed0af9641a90414f4dc3c23454b43d93c5dcb125cee1f00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000006f00000000000000000000000000000000000000000000000000000000004b6bcf8fb4556570a9dbdc252c766f813d49fd98f5b1c33f9055ae2d27ec90286593650000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000ef00000000000000000000000000000000000000000000000000000000004b6bcf7f4eb715a5edc0eba160203ebf802872780308942740e8930f4f630fce62fd3e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000001ef00000000000000000000000000000000000000000000000000000000004b6bcf389ad4f0fd0a8a3ac24dcf455be4078769be8fa364345337a24f8651531c2b8a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000003ef00000000000000000000000000000000000000000000000000000000004b6bcf66792a74b6d6de06ce4b641aef3b45dd66cba867bd194319095ac7cc8c1623aa0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000005ef00000000000000000000000000000000000000000000000000000000004b6bcf99964efc76b6b172ff43800c54499ca6a8bed4135438138cb1e53e327e9bcd7e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000def00000000000000000000000000000000000000000000000000000000004b6bcfd727388f4fa75a4b24bc51ba1f8b86c067f22cafb78cee48c6a03d7c7cbd83810000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000d0000000000000000000000000000000000000000000000000000000000001def00000000000000000000000000000000000000000000000000000000004b6bcf98b16d8209671c80d104de1cd2444d070a160caaa1b497fdb07affe266e536ef0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000002def00000000000000000000000000000000000000000000000000000000004b6bcfc0733aaf0b7fe0d957536a40a826ad11f894962c2d416fa1dd6f05bd5187cadf0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000000000000000006dea00000000000000000000000000000000000000000000000000000000004b6bcf41f42575f3473edf533e90f82a8f0688607fb67daf81cfb24bd706e81041932100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000ede700000000000000000000000000000000000000000000000000000000004b6bcfe238e11d2176360259f24e1cdf3f74304379e769be941794758c221a61430396000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000016c0200000000000000000000000000000000000000000000000000000000004b6bd54ba3de234678c9b3045b2fa1008551c4c8d4a013b60af7deccedfdf0b790b202"
    )


@pytest.fixture
def mock_block_hash() -> bytes:
    return bytes.fromhex("86193650adaf2d4a975406cd12bed968242527c579b0244360433598212824c5")


@pytest.fixture
def mock_encoded_chain_id() -> bytes:
    return bytes.fromhex("321162616e642d76332d746573746e65742d31")


@pytest.fixture
def mock_validator_power() -> dict[str, int]:
    return {
        "0x7b18b4666e238bdf2f89f0f3ba6021fb37cde255": 1000105,
        "0x23ae1110e602b8f923d5f7483922acef740d3b2f": 1000063,
        "0x4a88c4fc11f1cd276cec0fb92d72ff5f35bbea71": 1000043,
        "0x16984f6e3a61c2e3d5972deb3404c5cb687d8c7f": 1000041,
        "0xa04623e173833a6fd0ad638b2e2ae5a32a10d1d5": 1000036,
        "0x610b85e7887ed631232b444b5d4297f43eef75e7": 1000036,
        "0xae86749b4808dfd357ebc72b8d5207ab859354f2": 1000033,
        "0x8bb8ce4591dfaa96eee8b06ae89f375af6caf8bd": 1000028,
        "0x59742e8ce5505c35b5da69bbe0e90c77bce24cb2": 1000026,
        "0x15a7aacb5ba3a01cf1a33419c0d5e8b077bfc1fc": 1000025,
        "0x1e8a183edddbdf7da9846efbdba22085653da902": 1000025,
        "0x8d74b5a38498549499f22c695ca0c86d1636ff5d": 1000018,
        "0x02b8e5c82d3198e6927a6f35bf1e8a56e5147aa6": 1000016,
        "0x076ab5c2bfcff8327f5585da925f20a4dc7ccbf2": 1000015,
        "0x04a6f5a9fd28f8eb017768bd3f3651abbb4c58ac": 1000011,
        "0xdcef6edb775f4c3cd7a0956b4efdb2d93fa34a5e": 1000011,
        "0x6340c6b20d951d21cd18752631329ebdb10f6cee": 1000006,
        "0x50401460ebed7c0d24b08baf9f5899aeb8210f18": 1000005,
        "0x96a36cc9d52da4d08e6f13e7aa698631db09da1b": 1000003,
        "0x5e86e58b7e88d3ee46d86d3594c55c347a27ef6a": 1000003,
        "0x144109fb5f06a766d93bc2fceca778f48de90a55": 1000003,
        "0x6697f80f343ea83b51d2076c0c63f4c95c6ea869": 1000003,
        "0xd1b859555e3f96b14486895593e3a24d2980b6f6": 1000003,
        "0x333d4c05cdb2a8e69771ea7471bf4f1957541fed": 1000003,
        "0x817399bc6be80cfaf4efecd9b476670f34dbea9c": 1000003,
        "0x0235461ee439f694e1aa58d9d3ab0b36eafa84f9": 1000003,
        "0xe700a82991beed9bca4d3cff482dd173767f2075": 1000003,
        "0x2faacd4776dbed5150512f97724b74d8574885e0": 1000003,
        "0x281c1b6fbdddedf526422bbbf6de3cd973d8544b": 1000003,
        "0x774e72dfcc7416c3364cbc5296776eb6ddf0f4c5": 1000003,
        "0x9a99df7776152e8aa89fdf9410a4a6f6ef373883": 1000003,
        "0xed0cc7c7813df2ffec033d45884f6a9677e28d2a": 1000003,
        "0xc3a86ed9c995e96485677b4a4aea54c2d49cd0b3": 1000000,
        "0x4ad743674426d10add931011fe50b470d19f2884": 1000000,
        "0x46e6e0270b5aef54c774bce560a72f55615e7f8e": 1000000,
    }


def test_trim_proof(mock_evm_proof, mock_block_hash, mock_encoded_chain_id, mock_validator_power):
    trimmed_proof = trim_proof(
        mock_evm_proof,
        mock_block_hash,
        mock_encoded_chain_id,
        mock_validator_power,
    )
    expected_proof = bytes.fromhex(
        "0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000186000000000000000000000000000000000000000000000000000000000000018001d7e4b8fdb91d3c62f03fde7a502ef1f6e517b6455f91a1459c170734d56e83c6138eca2f2e6c71958539e1a5d346f8846226c92636dbfe82db2329857b613b81bbbdcdd9446268317903d992af3ffbbbd62ae3f87c0ad69c5e5fe503224bb1289e6175a7b2650180d387c403ae10475b70d77113fdbeea62dd0061d900093002879e29fbc1689ec000bd1489fe14974fe39a92233c6c423e0c7e85eaa5c9dea31d1ea84ba954cbbf975e2762f8b19c7da07d4add5b9414250c91de04dd11a81947000cd8780693dc08cb0a86f9f3db35d28ad2a7055de72095404edec76115000000000000000000000000000000000000000000000000000000000004b6bd60000000000000000000000000000000000000000000000000000000067e4f24e0000000000000000000000000000000000000000000000000000000036ea23553fb895ba5763257c803061586fd1f9f31d534dec9d91d6d571de6c58b24ca74c1619d4aa71f4a12f37645a141d8ffafe0ecd6ba98f7270926beab7a7178497cfdbd0de414957ecbf9eb0a6203d5e4de5ab1aed6bf680fcec58d8f139d2aa45c4c1b6c9892812d91aca9425a3440a75c54c0df7ee1508ea415046b09b2d19f1db000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000f080211d66b4b000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026122408011220ead12b282c85aefb0d415df82c564287f3a6bbac44749470aeca8c88a191a80600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000004800000000000000000000000000000000000000000000000000000000000000540000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000006c000000000000000000000000000000000000000000000000000000000000007800000000000000000000000000000000000000000000000000000000000000840000000000000000000000000000000000000000000000000000000000000090000000000000000000000000000000000000000000000000000000000000009c00000000000000000000000000000000000000000000000000000000000000a800000000000000000000000000000000000000000000000000000000000000b400000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000cc00000000000000000000000000000000000000000000000000000000000000d800000000000000000000000000000000000000000000000000000000000000e400000000000000000000000000000000000000000000000000000000000000f000000000000000000000000000000000000000000000000000000000000000fc000000000000000000000000000000000000000000000000000000000000010800000000000000000000000000000000000000000000000000000000000001140000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000012c00000000000000000000000000000000000000000000000000000000000001380000000000000000000000000000000000000000000000000000000000000144012055e45d3a2e6297f9309f08d920d8540b5742804d8627c38343a14a17589024c14cd6c9e1eef6d11e5851ae4a74155b92b3bdb1c3092a1db4f5de03ee0e2bf000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06108592f1d002000000000000000000000000000000000000000013bae22dc91385ea433004d784af443765eecb849892fca33dc842ac9a5613657b14eec7baa7fede0309d40b7c28ef99444e5460299f2b93ed1b936b67573a97000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f494ede60200000000000000000000000000000000000000004e3184dc913990b0209c4327408bbe9c5eba87afce293c6140ecb635c72bad673ef779dde0391a3172024daa4f4a1b5764a41e6409a38c35633652a31fff75e0000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ddbceede020000000000000000000000000000000000000000428044f0f4fdc61bc660063aac3b81b4d2661f792dd4f38fd814f36f4c19c6622a4452eb9a24eadebb648113b50f927b350a479565b25b1a76fa708260030d12000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610dd88c6d80200000000000000000000000000000000000000004375d7e130aa5138443ff45174d298058fdd4baff5c2ded7689b7a851b9e737732dce70a806dd5ec49aab4b1f27f7be990197bf685d4b2416e640c591687a745000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b181d4da02000000000000000000000000000000000000000028c350213268af29f25dcdbefe244a05d48abd3b25ef5b6d0e370aa8039798933d9d5eb8cb8708e81c7d489528c44fd56c2f8af709b04948fdbe09d130e20816000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ce94fde0020000000000000000000000000000000000000000938ee978a988320d1d8fc792c234745b87a0bfdd745b9724fd0cb702e89f60680555eea11c88af6a34d6e3e97ba86f826a8fc3a9cdd4e9bc903cc4be59bec455000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bd81a2d00200000000000000000000000000000000000000005f5febe1f0267df6445c550495c00faa9705c18a63e287caf8bbfe53a35b21d60f13aed64328252cbbf9c1ff0a3ec1bf1a8b59ae9c274ba4b62c1bc300c5bccb000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610e5beb9cd0200000000000000000000000000000000000000002e0729a1396b707d750ab066bb310ae3d6829e7c1aa2d100b25c011ae5ca54b74997de810963a7d0b14d507acc9605bac5726f8b95dc6954869b9d9abf3e495f000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b7bfc8ea020000000000000000000000000000000000000000d011d9c94344a1586e02349846513aea3927874c5f6249c2638a32c849effe247f37b96bf42034366c465afea6cf13f82c3e4852618496e947f52faf81f9cdf1000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610c5b4c7fe02000000000000000000000000000000000000000097d8951e55ccdcf1db77b7cfb1f059c2806e17ab4eacc510e49a8377d351ab3c0123099b90d8266bb2182eab09fdd173ed4fdf99dc93b5ad729c6424254474a6000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06109f9ce6d0020000000000000000000000000000000000000000eef9b3aa497cc56c08d96448ace0ac05108a7b83bfa9ed604d47648ae52987c23d9173f1bd2491ca990dd5584d78b810f014911e53cfe889df07ecbab1a04183000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f2a1edcc0200000000000000000000000000000000000000005aeed6f353bce82c13463ec2863131b0c5409cee51657258bd9da63807cc5de73104f58ccd8654db72cff3f7a68e3ece9a5087c2f026c40fc9a83a42a2b24b90000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000b08d0e493bf06109cc59310000000000000000000000000000000000000000000f30c639044188427b5eaecc532645024a7bc0d8c8d591cea9b5bd3b09448645c5b5727b2fe804495325d06a4d4f99137d00823ac0804867901870a9899b8ea41000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf061086c4e3f702000000000000000000000000000000000000000044ac7e69a1b7291d0bff41e411b451ba6fba9f1c1af3a7a93525e7462c3a6361414986a53f020de4d3044d5f158a2c2d702e95b7f6b1b2764edf400e4e814701000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bf9987d30200000000000000000000000000000000000000008ee5e304e4432fc93b1357b22d42c3dd0237057cb49f37d51973454fe52a008f1439e5961e6bd12add46d0691dc42600411e3851522b00771fa25684af4551a8000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ee9186d50200000000000000000000000000000000000000004c4456aded10eb474325de34c21750ce50128f615522b13f2f77288b8219c09513a82c3a7e44581a031a62e57a7abef4ea38a894577749b6dbaa51e104f62379000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06109291a7d502000000000000000000000000000000000000000067cd71cadd788be05b0c2befc771360d854627ad779b6e13d2960f12244a96bf61762b96220fac84ac59c57039d2830d36888326d5ca8bf2f36433d87b2ea46a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf06108cd4b9e1020000000000000000000000000000000000000000b8461c2c37de3f0169dc1ea274ee10d782d9bcfefa57147754172bb349f12d68444fb66d04717d4b95e96a9abd8d06ebeaab69d5fd45d4dc7fde2cde794082dc000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b49c85d202000000000000000000000000000000000000000054b732ae6fbdf6eac87eee414389fd6b7df651bc8f7c5d9f0619c30f1c9182982a51247b9d43c50b8e516a406c2df20cad213246c0cc9936c35ca712e1fc2be6000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610b4d9dad3020000000000000000000000000000000000000000024609f514120df47a9c31093a52b176c5f8b28df0ca02cf270e01c14447f284455958343d12d6b341ae3b23d8307bc6517f723ef2a607a2aa980f6b9e446aed000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610f1dba4ce0200000000000000000000000000000000000000006f78bc36c0ef172abfb488bfa38bac26dafdb97e4875e2b1f42f2511add2433f005976eaea645423246b73e3e37abff0d1a0343b823601cbe2a84772b3836c8d000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610bfe48794030000000000000000000000000000000000000000d58ef62a35f9d93c4cb5036135d188b89078a965c5375e3e29963b98a8cae5d1242ed3908f99bbe00665c613b0ca4be7c12d4a399674ccc6addaebd24c7ca013000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610c2f3d0f4020000000000000000000000000000000000000000308c44836126967ac264dc12ad92da8818f8b2598fb37b44939b5c8cbc4a2d6e7e2dc5e8d60966e29052d6ec5836c63c15b46d44a1554881646b53069f2abcd4000000000000000000000000000000000000000000000000000000000000001b0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000c08cfe493bf0610ec9aa3cc0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dc000000000000000000000000000000000000000000000000000000000004b6bd6000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000004b6bcf00000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000016ba800000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000067e4f2440000000000000000000000000000000000000000000000000000000067e4f24600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000000a7672665f776f726b6572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044000000205c8ae7cfab9f5b0e1be04a5cc6b00f51844d92cac71322190e030fdc82a5e5a90000000067e3670800000014b5a4643d61f2bc214d453b501c2d06089e6880d3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000203a0ae8974c402d8286e4b71dceb368a96cbf80aaecb2ef99b7dd983b06267ea700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000004b6bcf8ecb7eca2dff1794f1b0cf4ee02d7ccdc3b68f20bda482bec659059fcf93ff8a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000004b6bcfe4f1f38396518d67512a53fab3b46aac97bd15e9142bcfb218a290712c4dc7f600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000004b6bcf0231216a07400fab9e45d493fbb411834622c7f3ace58197f4ed746abdb9e10600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000000000000004b6bcf090bb53ef4d133b4be4a0611ee9b513731188dbdf7ea4958ef4895d5dfea8a8100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001f00000000000000000000000000000000000000000000000000000000004b6bcf925a8a7af4548e8f10ad98439bd20c11172d31ba479662d9e1b8998f778ccdac00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002f00000000000000000000000000000000000000000000000000000000004b6bcfa69a5ba6060b08a51e2ed0af9641a90414f4dc3c23454b43d93c5dcb125cee1f00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000006f00000000000000000000000000000000000000000000000000000000004b6bcf8fb4556570a9dbdc252c766f813d49fd98f5b1c33f9055ae2d27ec90286593650000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000ef00000000000000000000000000000000000000000000000000000000004b6bcf7f4eb715a5edc0eba160203ebf802872780308942740e8930f4f630fce62fd3e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000001ef00000000000000000000000000000000000000000000000000000000004b6bcf389ad4f0fd0a8a3ac24dcf455be4078769be8fa364345337a24f8651531c2b8a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000003ef00000000000000000000000000000000000000000000000000000000004b6bcf66792a74b6d6de06ce4b641aef3b45dd66cba867bd194319095ac7cc8c1623aa0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000005ef00000000000000000000000000000000000000000000000000000000004b6bcf99964efc76b6b172ff43800c54499ca6a8bed4135438138cb1e53e327e9bcd7e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000def00000000000000000000000000000000000000000000000000000000004b6bcfd727388f4fa75a4b24bc51ba1f8b86c067f22cafb78cee48c6a03d7c7cbd83810000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000d0000000000000000000000000000000000000000000000000000000000001def00000000000000000000000000000000000000000000000000000000004b6bcf98b16d8209671c80d104de1cd2444d070a160caaa1b497fdb07affe266e536ef0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000002def00000000000000000000000000000000000000000000000000000000004b6bcfc0733aaf0b7fe0d957536a40a826ad11f894962c2d416fa1dd6f05bd5187cadf0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000000000000000006dea00000000000000000000000000000000000000000000000000000000004b6bcf41f42575f3473edf533e90f82a8f0688607fb67daf81cfb24bd706e81041932100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000ede700000000000000000000000000000000000000000000000000000000004b6bcfe238e11d2176360259f24e1cdf3f74304379e769be941794758c221a61430396000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000016c0200000000000000000000000000000000000000000000000000000000004b6bd54ba3de234678c9b3045b2fa1008551c4c8d4a013b60af7deccedfdf0b790b202"
    )

    assert trimmed_proof == expected_proof


def test_recover_address():
    sig = (
        0xDBCED675869BDCF29286AB93892A28A38AE4578122F27DDFC96AB2372251ABF9,
        0x23C0B07CD7CE1658E203B23CAF8F00283AEEEE7E862E70D8139D5A7E02FD17FD,
        27,
        bytes.fromhex("08ecd983bf0610f799999b01"),
    )
    common = bytes.fromhex(
        "080211f88a47000000000022480a20541925fbed3d3e95d4952d3c60efe8eb3c1ef5873083e885cd136291f270534d122408011220e4095ca3af00b49525bf08c721f279d92d7178c401444cb15e21ded82b2717d0"
    )
    encoded_band_chain_id = bytes.fromhex("321162616e642d76332d746573746e65742d31")
    assert _recover_address(sig, common, encoded_band_chain_id) == "0x0235461ee439f694e1aa58d9d3ab0b36eafa84f9"
